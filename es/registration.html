<!DOCTYPE html>
<html lang="en-GB">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Natalia & Xavier</title>
    <link rel="icon" type="image/x-icon" href="../media/img/olive_branch.png">

    <link rel="stylesheet" href="../css/text-styles.css">
    <link rel="stylesheet" href="../css/inline-fonts.css">
    <link rel="stylesheet" href="../css/page-layout.css">
    <link rel="stylesheet" href="../css/widgets.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>
        .shadow-kiss {
            /* The image used */
            background-image: url("../media/img/shadow_kiss.jpg");

            /* Full height */
            height: 100%;

            /* Center and scale the image nicely */
            background-position: bottom;
            background-repeat: no-repeat;
            background-size: cover;
        }
    </style>

</head>

<body>

<div class="nav-bar">
    <a href="../index.html"><i class="fa fa-home"></i></a>
    <a href="invitation.html">Boda</a>
    <a href="information.html">Úbeda</a>
    <a class="active" href="registration.html">Registrarse</a>
    <a href="dresscode.html">Black Tie</a>
    <div class="nav-bar-right">
        <a href="../en/registration.html"><img src="../media/img/flag_uk.png"></a>
        <a href="../es/registration.html"><img src="../media/img/flag_es.png"></a>
        <a href="../nl/registration.html"><img src="../media/img/flag_be.png"></a>
        <a href="../fr/registration.html"><img src="../media/img/flag_fr.png"></a>
    </div>
</div>


<div class="content-double">
    <div>
        <h3>Confirmar Asistencia</h3>

        <form
                id="wedding-registration"
                method="POST"
                action="https://script.google.com/macros/s/AKfycbwUE6IeL1lOI0_J5FjTbtUR-AMs9s4iIwrNvxSgDfy4qd-0WUPW9rYvoxwlA5qFa3jP/exec"
        >

            <!--Form heading-->
            <div style="width:80%;">
                <p>Nombres</p>
            </div>
            <div style="width:20%;">
                <p>Asistencia</p>
            </div>

            <!--First guest name & attendance-->
            <div style="width:40%; height:32px">
                <input id="Guest1FirstName" name="Guest1FirstName" type="text" placeholder="Nombre" required>
            </div>
            <div style="width:40%; height:32px">
                <input id="Guest1SurName" name="Guest1SurName" type="text" placeholder="Apellido" required>
            </div>
            <div style="width:20%; height:32px">
                <select id="Attending" name="Attending">
                    <option value="yes">Si</option>
                    <option value="no">No</option>
                </select>
            </div>

            <!--Second guest name -->
            <div style="width:40%; height:32px">
                <input id="Guest2FirstName" name="Guest2FirstName" type="text" placeholder="Nombre" required>
            </div>
            <div style="width:40%; height:32px">
                <input id="Guest2SurName" name="Guest2SurName" type="text" placeholder="Apellido" required>
            </div>
            <div style="width:20%; height:32px">
                <div style="width:10%; height:32px">
                    <input type="hidden" id="HasPlusOneDefault" name="HasPlusOne" value="yes">
                    <input type="checkbox" id="HasPlusOne" name="HasPlusOne" value="no" onchange="onPartnerCheckBoxChange()">
                </div>
                <div style="width:90%; height:32px">
                    <label for="HasPlusOne">Sin pareja</label>
                </div>
            </div>

            <!--Children -->
            <div style="width:100%;">
                <p>Niños</p>
            </div>
            <div style="width:20%; height:32px">
                <select id="Children" name="Children" onchange="onChildrenUpdated()">
                    <option value=0>No</option>
                    <option value=1>1</option>
                    <option value=2>2</option>
                    <option value=3>3</option>
                    <option value=4>4</option>
                    <option value=5>5</option>
                </select>
            </div>
            <div style="width:80%; height:32px"></div>


            <!--First Child -->
            <div id="C_Child1Name" style="width:50%; height:32px">
                <input id="Child1Name" name="Child1Name" type="text" placeholder="Nombre" required>
            </div>
            <div id="C_Child1Age" style="width:8%; height:32px; min-width:16px;">
                <input id="Child1Age" name="Child1Age" type="number" placeholder="Edad" required>
            </div>
            <div style="width:2%; height:32px"></div>
            <div id="C_Child1Menu" style="width:20%; height:32px">
                <select id="Child1Menu" name="Child1Menu">
                    <option value="No Food">No Comida</option>
                    <option value="Child Menu">Menú Infantil</option>
                    <option value="Full Menu">Menú Normal</option>
                </select>
            </div>
            <div id="C_Child1Chair" style="width:20%; height:32px">
                <select id="Child1Chair" name="Child1Chair">
                    <option value="No">Sin Trona</option>
                    <option value="Yes">Trona</option>
                </select>
            </div>

            <!--Second Child -->
            <div id="C_Child2Name" style="width:50%; height:32px">
                <input id="Child2Name" name="Child2Name" type="text" placeholder="Nombre" required>
            </div>
            <div id="C_Child2Age" style="width:8%; height:32px">
                <input id="Child2Age" name="Child2Age" type="number" placeholder="Edad" required>
            </div>
            <div style="width:2%; height:32px"></div>
            <div id="C_Child2Menu" style="width:20%; height:32px">
                <select id="Child2Menu" name="Child2Menu">
                    <option value="No Food">No Comida</option>
                    <option value="Child Menu">Menú Infantil</option>
                    <option value="Full Menu">Menú Normal</option>
                </select>
            </div>
            <div id="C_Child2Chair" style="width:20%; height:32px">
                <select id="Child2Chair" name="Child2Chair">
                    <option value="No">Sin Trona</option>
                    <option value="Yes">Trona</option>
                </select>
            </div>

            <!--Third Child -->
            <div id="C_Child3Name" style="width:50%; height:32px">
                <input id="Child3Name" name="Child3Name" type="text" placeholder="Nombre" required>
            </div>
            <div id="C_Child3Age" style="width:8%; height:32px">
                <input id="Child3Age" name="Child3Age" type="number" placeholder="Edad" required>
            </div>
            <div style="width:2%; height:32px"></div>
            <div id="C_Child3Menu" style="width:20%; height:32px">
                <select id="Child3Menu" name="Child3Menu">
                    <option value="No Food">No Comida</option>
                    <option value="Child Menu">Menú Infantil</option>
                    <option value="Full Menu">Menú Normal</option>
                </select>
            </div>
            <div id="C_Child3Chair" style="width:20%; height:32px">
                <select id="Child3Chair" name="Child3Chair">
                    <option value="No">Sin Trona</option>
                    <option value="Yes">Trona</option>
                </select>
            </div>

            <!--Fourth Child -->
            <div id="C_Child4Name" style="width:50%; height:32px">
                <input id="Child4Name" name="Child4Name" type="text" placeholder="Nombre" required>
            </div>
            <div id="C_Child4Age" style="width:8%; height:32px">
                <input id="Child4Age" name="Child4Age" type="number" placeholder="Edad" required>
            </div>
            <div style="width:2%; height:32px"></div>
            <div id="C_Child4Menu" style="width:20%; height:32px">
                <select id="Child4Menu" name="Child4Menu">
                    <option value="No Food">No Comida</option>
                    <option value="Child Menu">Menú Infantil</option>
                    <option value="Full Menu">Menú Normal</option>
                </select>
            </div>
            <div id="C_Child4Chair" style="width:20%; height:32px">
                <select id="Child4Chair" name="Child4Chair">
                    <option value="No">Sin Trona</option>
                    <option value="Yes">Trona</option>
                </select>
            </div>

            <!--Fifth Child -->
            <div id="C_Child5Name" style="width:50%; height:32px">
                <input id="Child5Name" name="Child5Name" type="text" placeholder="Nombre" required>
            </div>
            <div id="C_Child5Age" style="width:8%; height:32px">
                <input id="Child5Age" name="Child5Age" type="number" placeholder="Edad" required>
            </div>
            <div style="width:2%; height:32px"></div>
            <div id="C_Child5Menu" style="width:20%; height:32px">
                <select id="Child5Menu" name="Child5Menu">
                    <option value="No Food">No Comida</option>
                    <option value="Child Menu">Menú Infantil</option>
                    <option value="Full Menu">Menú Normal</option>
                </select>
            </div>
            <div id="C_Child5Chair" style="width:20%; height:32px">
                <select id="Child5Chair" name="Child5Chair">
                    <option value="No">Sin Trona</option>
                    <option value="Yes">Trona</option>
                </select>
            </div>

            <!--Dietary Restrictions -->
            <div style="width:100%">
                <p>Restricciones Dietéticas </p>
                <span class="resize-input" style="width:100%; vertical-align:top">
                    <input type="hidden" id="DietaryRestrictionsDefault" name="DietaryRestrictions" value="None">
                    <input style="vertical-align:top;" name="DietaryRestrictions" type="text" placeholder="Ninguna">
                </span>
            </div>

            <!--Submission button-->
            <br>
            <br>
            <button type="submit"><b>CONFIRMAR</b></button>
        </form>
    </div>

    <div class="shadow-kiss"></div>

</div>

<div id="dialog_overlay" class="dialog_overlay" hidden>
    <dialog id="dialog_wait">
        <p>Submitting registration</p>
    </dialog>
    <dialog id="dialog_success">
        <p>Registration successful</p>
        <button onclick="closeConfirmationDialog()"><b>close</b></button>
    </dialog>
    <dialog id="dialog_failure">
        <p>Registration failed</p>
        <button onclick="closeConfirmationDialog()"><b>close</b></button>
    </dialog>
</div>


<!--Script to enable/disable partner input-->
<script>
    function onPartnerCheckBoxChange() {
       const checkbox = document.getElementById("HasPlusOne");
       const checked = checkbox.checked;
       try {
           if (checked) {
               document.getElementById("Guest2FirstName").disabled = true;
               document.getElementById("Guest2SurName").disabled = true;
           } else {
               document.getElementById("Guest2FirstName").disabled = false;
               document.getElementById("Guest2SurName").disabled = false;
           }
       } catch (error) {
           window.alert(error.message + "\n" + error.stackTrace);
       }
    }
</script>

<!--Script to hide/un-hide children inputs-->
<script>
    function onChildrenUpdated() {
        const children = document.getElementById("Children");
        const count = parseInt(children.value)
        try {
            if (count >= 5) {
                document.getElementById("C_Child5Name").style.display = "block";
                document.getElementById("C_Child5Age").style.display = "block";
                document.getElementById("C_Child5Menu").style.display = "block";
                document.getElementById("C_Child5Chair").style.display = "block";
                document.getElementById("Child5Name").disabled = false;
                document.getElementById("Child5Age").disabled = false;
                document.getElementById("Child5Menu").disabled = false;
                document.getElementById("Child5Chair").disabled = false;
            }
            if (count >= 4) {
                document.getElementById("C_Child4Name").style.display = "block";
                document.getElementById("C_Child4Age").style.display = "block";
                document.getElementById("C_Child4Menu").style.display = "block";
                document.getElementById("C_Child4Chair").style.display = "block";
                document.getElementById("Child4Name").disabled = false;
                document.getElementById("Child4Age").disabled = false;
                document.getElementById("Child4Menu").disabled = false;
                document.getElementById("Child4Chair").disabled = false;
            }
            if (count >= 3) {
                document.getElementById("C_Child3Name").style.display = "block";
                document.getElementById("C_Child3Age").style.display = "block";
                document.getElementById("C_Child3Menu").style.display = "block";
                document.getElementById("C_Child3Chair").style.display = "block";
                document.getElementById("Child3Name").disabled = false;
                document.getElementById("Child3Age").disabled = false;
                document.getElementById("Child3Menu").disabled = false;
                document.getElementById("Child3Chair").disabled = false;
            }
            if (count >= 2) {
                document.getElementById("C_Child2Name").style.display = "block";
                document.getElementById("C_Child2Age").style.display = "block";
                document.getElementById("C_Child2Menu").style.display = "block";
                document.getElementById("C_Child2Chair").style.display = "block";
                document.getElementById("Child2Name").disabled = false;
                document.getElementById("Child2Age").disabled = false;
                document.getElementById("Child2Menu").disabled = false;
                document.getElementById("Child2Chair").disabled = false;
            }
            if (count >= 1) {
                document.getElementById("C_Child1Name").style.display = "block";
                document.getElementById("C_Child1Age").style.display = "block";
                document.getElementById("C_Child1Menu").style.display = "block";
                document.getElementById("C_Child1Chair").style.display = "block";
                document.getElementById("Child1Name").disabled = false;
                document.getElementById("Child1Age").disabled = false;
                document.getElementById("Child1Menu").disabled = false;
                document.getElementById("Child1Chair").disabled = false;
            }
            if (count <= 0) {
                document.getElementById("Child1Name").disabled = true;
                document.getElementById("Child1Age").disabled = true;
                document.getElementById("Child1Menu").disabled = true;
                document.getElementById("Child1Chair").disabled = true;
                document.getElementById("C_Child1Name").style.display = "none";
                document.getElementById("C_Child1Age").style.display = "none";
                document.getElementById("C_Child1Menu").style.display = "none";
                document.getElementById("C_Child1Chair").style.display = "none";
            }
            if (count <= 1) {
                document.getElementById("Child2Name").disabled = true;
                document.getElementById("Child2Age").disabled = true;
                document.getElementById("Child2Menu").disabled = true;
                document.getElementById("Child2Chair").disabled = true;
                document.getElementById("C_Child2Name").style.display = "none";
                document.getElementById("C_Child2Age").style.display = "none";
                document.getElementById("C_Child2Menu").style.display = "none";
                document.getElementById("C_Child2Chair").style.display = "none";
            }
            if (count <= 2) {
                document.getElementById("Child3Name").disabled = true;
                document.getElementById("Child3Age").disabled = true;
                document.getElementById("Child3Menu").disabled = true;
                document.getElementById("Child3Chair").disabled = true;
                document.getElementById("C_Child3Name").style.display = "none";
                document.getElementById("C_Child3Age").style.display = "none";
                document.getElementById("C_Child3Menu").style.display = "none";
                document.getElementById("C_Child3Chair").style.display = "none";
            }
            if (count <= 3) {
                document.getElementById("Child4Name").disabled = true;
                document.getElementById("Child4Age").disabled = true;
                document.getElementById("Child4Menu").disabled = true;
                document.getElementById("Child4Chair").disabled = true;
                document.getElementById("C_Child4Name").style.display = "none";
                document.getElementById("C_Child4Age").style.display = "none";
                document.getElementById("C_Child4Menu").style.display = "none";
                document.getElementById("C_Child4Chair").style.display = "none";
            }
            if (count <= 4) {
                document.getElementById("Child5Name").disabled = true;
                document.getElementById("Child5Age").disabled = true;
                document.getElementById("Child5Menu").disabled = true;
                document.getElementById("Child5Chair").disabled = true;
                document.getElementById("C_Child5Name").style.display = "none";
                document.getElementById("C_Child5Age").style.display = "none";
                document.getElementById("C_Child5Menu").style.display = "none";
                document.getElementById("C_Child5Chair").style.display = "none";
            }
        } catch (error) {
            window.alert(error.message + "\n" + error.stackTrace);
        }
    }
</script>

<!--Event listener to call the children update method on document load-->
<script>
    window.onload = function() {
        onChildrenUpdated();
    };
</script>

<!--Script to close the confirmation dialogs-->
<script>
    function closeConfirmationDialog() {
        document.getElementById('dialog_success').close();
        document.getElementById('dialog_failure').close();
        document.getElementById('dialog_overlay').hidden = true;
    }
</script>

<!--Add event listeners-->
<script>
    // Add event listener for form submission
    window.addEventListener("load", function () {
        const form = document.getElementById('wedding-registration');
        form.addEventListener("submit", async function (e) {
            e.preventDefault();
            document.getElementById('dialog_overlay').hidden = false;
            document.getElementById('dialog_wait').show();
            const data = new FormData(form);
            const action = e.target.action;
            try {
                const reply = await fetch(action, {
                    method: 'POST',
                    body: data,
                })
                const json = await reply.json();
                const result = json['result'];
                document.getElementById('dialog_wait').close();
                if (result === 'success') {
                    document.getElementById('dialog_success').show();
                } else {
                    document.getElementById('dialog_failure').show();
                }
            } catch (error) {
                document.getElementById('dialog_success').close();
                document.getElementById('dialog_failure').show();
            }
        });
    });
</script>

</body>
</html>